<div class="container mt-3">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h2 class="fw-bold">Lista de Vagas Internas</h2>
  </div>

  <!-- Search Bar -->
  <div class="bg-light p-3 rounded mb-4">
    <div class="input-group">
      <span class="input-group-text bg-white border-end-0"><i class="bi bi-search"></i></span>
      <input 
        type="text" 
        class="form-control border-start-0" 
        placeholder="Pesquisar vaga..." 
        [(ngModel)]="searchTerm"
        (input)="filterVagas()">
      <button class="btn btn-primary">Pesquisar</button>
    </div>
  </div>

  <!-- Filters -->
  <div class="row mb-4">
    <div class="col-md-6 d-flex gap-2">
      <select 
        id="cidade" 
        class="form-select" 
        [(ngModel)]="selectedCity" 
        (change)="filterVagas()">
        <option value="">Todas as cidades</option>
        <option *ngFor="let cidade of cidades" [value]="cidade">{{ cidade }}</option>
      </select>
      <select 
        id="setor" 
        class="form-select" 
        [(ngModel)]="selectedSetor" 
        (change)="filterVagas()">
        <option value="">Todos os setores</option>
        <option *ngFor="let setor of setores" [value]="setor">{{ setor }}</option>
      </select>
    </div>
    <div class="col-md-6 d-flex justify-content-end">
      <select class="form-select w-auto" 
      [(ngModel)]="selectedOrder" 
      (change)="filterVagas()">
      <option value="dateNewest">Data (Mais recentes)</option>
      <option value="dateOldest">Data (Mais antigos)</option>
      <option value="alphabetical">Ordem alfabética</option>
      </select>
    </div>
  </div>

  <!-- Job Cards -->
  <div 
    class="row g-4 vacancy-list"
    (touchstart)="onTouchStart($event)" 
    (touchend)="onTouchEnd($event)"
  >
    <div class="col-md-4" *ngFor="let vaga of paginatedVagas">
      <div class="card border-0 shadow h-100">
        <div class="card-body">
          <h5 class="card-title">{{ vaga.descric }}</h5>
          <p class="text-muted">{{ vaga.cidade }} | {{ vaga.cc }}</p>
          <p class="text-muted">{{ vaga.dtabert | dateFormater }}</p>
          <p class="text-truncate">{{ vaga.perfi | slice:0:100 }}...</p>
          <button 
            class="btn btn-outline-primary w-100" 
            (click)="openModal(vaga)">
            Ver detalhes
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- No Results -->
  <ng-template #noResults>
    <p class="text-center">Nenhuma vaga encontrada.</p>
  </ng-template>
  
  <div class="pagination">
    <button (click)="goToPreviousPage()" [disabled]="currentPage === 1">Anterior</button>
    <span>Página {{ currentPage }} de {{ totalPages }}</span>
    <button (click)="goToNextPage()" [disabled]="currentPage === totalPages">Próxima</button>
  </div>

  <!-- Job Details Modal -->
  <div 
    class="modal fade bd-modal-xl" 
    id="detalhesModal" 
    tabindex="-1" 
    aria-labelledby="detalhesModalLabel" 
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content">
        <div class="modal-header text-light bg-primary">
          <h3 class="modal-title text-center" id="detalhesModalLabel">{{ vagaSelecionada?.descric }}</h3>
          <button 
            type="button" 
            class="btn-close" 
            data-bs-dismiss="modal" 
            aria-label="Close">
          </button>
        </div>
        <div class="modal-body">
          <p><strong>Cidade:</strong> {{ vagaSelecionada?.cidade }}</p>
          <p><strong>Setor:</strong> {{ vagaSelecionada?.cc }}</p>
          <p><strong>Descrição:</strong></p>
          <p>{{ vagaSelecionada?.perfi }}</p>
        </div>
        <div class="modal-footer">
          <button 
            type="button" 
            class="btn btn-secondary" 
            data-bs-dismiss="modal">
            Fechar
          </button>
          <button
          type="button"
            class="btn btn-primary"
            
            (click)="redirecionarParaCurriculo(vagaSelecionada)"
            data-bs-dismiss="modal"
          >
            Cadastrar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
